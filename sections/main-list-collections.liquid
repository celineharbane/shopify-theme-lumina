{%- comment -%}
  LUMINA Theme - List Collections Section
{%- endcomment -%}

<section class="main-list-collections section-padding">
  <div class="page-width">

    <header class="main-list-collections__header">
      <h1 class="main-list-collections__title h2">{{ 'collections.general.title' | t }}</h1>
    </header>

    {%- paginate collections by section.settings.collections_per_page -%}

      {%- if collections.size > 0 -%}
        <div class="main-list-collections__grid" style="--columns-desktop: {{ section.settings.columns_desktop }}; --columns-mobile: {{ section.settings.columns_mobile }};">
          {%- for collection in collections -%}
            {%- unless collection.handle == 'all' -%}
              <a href="{{ collection.url }}" class="collection-card" data-animate>
                <div class="collection-card__image-wrapper" style="--aspect-ratio: {% case section.settings.image_ratio %}{% when 'square' %}1/1{% when 'portrait' %}2/3{% when 'landscape' %}4/3{% endcase %};">
                  {%- if collection.image -%}
                    {{ collection.image | image_url: width: 600 | image_tag:
                      loading: 'lazy',
                      sizes: '(min-width: 990px) 25vw, (min-width: 750px) 33vw, 50vw',
                      widths: '300, 450, 600',
                      alt: collection.title,
                      class: 'collection-card__image'
                    }}
                  {%- elsif collection.products.first -%}
                    {{ collection.products.first.featured_image | image_url: width: 600 | image_tag:
                      loading: 'lazy',
                      sizes: '(min-width: 990px) 25vw, (min-width: 750px) 33vw, 50vw',
                      widths: '300, 450, 600',
                      alt: collection.title,
                      class: 'collection-card__image'
                    }}
                  {%- else -%}
                    {{ 'collection-1' | placeholder_svg_tag: 'collection-card__placeholder' }}
                  {%- endif -%}
                </div>

                <div class="collection-card__content">
                  <h2 class="collection-card__title h4">{{ collection.title }}</h2>
                  {%- if section.settings.show_collection_count -%}
                    <p class="collection-card__count">
                      {{ 'collections.general.items_with_count' | t: count: collection.all_products_count }}
                    </p>
                  {%- endif -%}
                </div>
              </a>
            {%- endunless -%}
          {%- endfor -%}
        </div>

        {%- if paginate.pages > 1 -%}
          {%- render 'pagination', paginate: paginate -%}
        {%- endif -%}

      {%- else -%}
        <p class="main-list-collections__empty">{{ 'collections.general.empty' | t }}</p>
      {%- endif -%}

    {%- endpaginate -%}
  </div>
</section>

<style>
.main-list-collections__header {
  text-align: center;
  margin-bottom: 3rem;
}

.main-list-collections__title {
  margin: 0;
}

.main-list-collections__grid {
  display: grid;
  grid-template-columns: repeat(var(--columns-mobile, 2), 1fr);
  gap: var(--grid-gap);
}

@media (min-width: 750px) {
  .main-list-collections__grid {
    grid-template-columns: repeat(var(--columns-desktop, 4), 1fr);
  }
}

.collection-card {
  display: block;
  text-decoration: none;
  color: inherit;
  border-radius: var(--border-radius);
  overflow: hidden;
  background: var(--color-background);
  border: 1px solid var(--color-border);
  transition: box-shadow 0.3s ease, transform 0.3s ease;
}

.collection-card:hover {
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
  transform: translateY(-4px);
}

.collection-card__image-wrapper {
  position: relative;
  aspect-ratio: var(--aspect-ratio, 1/1);
  overflow: hidden;
  background: var(--color-background-secondary);
}

.collection-card__image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.5s ease;
}

.collection-card:hover .collection-card__image {
  transform: scale(1.05);
}

.collection-card__placeholder {
  width: 100%;
  height: 100%;
}

.collection-card__content {
  padding: 1.25rem;
  text-align: center;
}

.collection-card__title {
  margin: 0 0 0.25rem;
  font-size: 1.125rem;
}

.collection-card__count {
  margin: 0;
  font-size: 0.875rem;
  color: var(--color-text-light);
}

.main-list-collections__empty {
  text-align: center;
  padding: 3rem;
  color: var(--color-text-light);
}
</style>

{% schema %}
{
  "name": "Collection list page",
  "tag": "section",
  "class": "section-main-list-collections",
  "settings": [
    {
      "type": "range",
      "id": "collections_per_page",
      "min": 8,
      "max": 24,
      "step": 4,
      "default": 16,
      "label": "Collections per page"
    },
    {
      "type": "range",
      "id": "columns_desktop",
      "min": 2,
      "max": 6,
      "step": 1,
      "default": 4,
      "label": "Columns on desktop"
    },
    {
      "type": "select",
      "id": "columns_mobile",
      "label": "Columns on mobile",
      "options": [
        { "value": "1", "label": "1 column" },
        { "value": "2", "label": "2 columns" }
      ],
      "default": "2"
    },
    {
      "type": "select",
      "id": "image_ratio",
      "label": "Image ratio",
      "options": [
        { "value": "square", "label": "Square (1:1)" },
        { "value": "portrait", "label": "Portrait (2:3)" },
        { "value": "landscape", "label": "Landscape (4:3)" }
      ],
      "default": "portrait"
    },
    {
      "type": "checkbox",
      "id": "show_collection_count",
      "label": "Show product count",
      "default": true
    }
  ]
}
{% endschema %}
