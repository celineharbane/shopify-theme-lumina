{%- comment -%}
  LUMINA Theme - Main Blog Section
{%- endcomment -%}

<section class="main-blog section-padding" data-section-id="{{ section.id }}">
  <div class="page-width">

    {%- comment -%} Blog Header {%- endcomment -%}
    <header class="main-blog__header">
      <h1 class="main-blog__title h2">{{ blog.title }}</h1>
      {%- if current_tags -%}
        <p class="main-blog__current-tag">
          {{ 'blogs.article.tags' | t }}: {{ current_tags | join: ', ' }}
          <a href="{{ blog.url }}" class="main-blog__clear-tag">{{ 'products.facets.clear' | t }}</a>
        </p>
      {%- endif -%}
    </header>

    {%- paginate blog.articles by section.settings.articles_per_page -%}

      {%- if blog.articles.size > 0 -%}
        <div class="main-blog__grid" style="--columns-desktop: {{ section.settings.columns_desktop }}; --columns-mobile: {{ section.settings.columns_mobile }};">
          {%- for article in blog.articles -%}
            <article class="blog-card" data-animate>
              {%- if section.settings.show_featured_image and article.image -%}
                <a href="{{ article.url }}" class="blog-card__image">
                  {{ article.image | image_url: width: 600 | image_tag:
                    loading: 'lazy',
                    sizes: '(min-width: 990px) 33vw, (min-width: 750px) 50vw, 100vw',
                    widths: '300, 450, 600',
                    alt: article.title
                  }}
                </a>
              {%- endif -%}

              <div class="blog-card__content">
                {%- if section.settings.show_date or section.settings.show_author -%}
                  <div class="blog-card__meta">
                    {%- if section.settings.show_date -%}
                      <time datetime="{{ article.published_at | date: '%Y-%m-%d' }}">
                        {{ article.published_at | date: format: 'date' }}
                      </time>
                    {%- endif -%}
                    {%- if section.settings.show_author -%}
                      <span class="blog-card__author">{{ article.author }}</span>
                    {%- endif -%}
                  </div>
                {%- endif -%}

                <h2 class="blog-card__title h4">
                  <a href="{{ article.url }}">{{ article.title }}</a>
                </h2>

                {%- if section.settings.show_excerpt and article.excerpt_or_content != blank -%}
                  <p class="blog-card__excerpt">
                    {{ article.excerpt_or_content | strip_html | truncate: 150 }}
                  </p>
                {%- endif -%}

                <a href="{{ article.url }}" class="blog-card__link">
                  {{ 'blogs.article.read_more' | t }}
                  {%- render 'icon-arrow-right' -%}
                </a>
              </div>
            </article>
          {%- endfor -%}
        </div>

        {%- if paginate.pages > 1 -%}
          {%- render 'pagination', paginate: paginate -%}
        {%- endif -%}

      {%- else -%}
        <p class="main-blog__empty">{{ 'collections.general.empty' | t }}</p>
      {%- endif -%}

    {%- endpaginate -%}
  </div>
</section>

<style>
.main-blog__header {
  text-align: center;
  margin-bottom: 3rem;
}

.main-blog__title {
  margin-bottom: 0.5rem;
}

.main-blog__current-tag {
  color: var(--color-text-light);
  font-size: 0.9375rem;
}

.main-blog__clear-tag {
  color: var(--color-primary);
  margin-left: 0.5rem;
}

.main-blog__grid {
  display: grid;
  grid-template-columns: repeat(var(--columns-mobile, 1), 1fr);
  gap: var(--grid-gap);
}

@media (min-width: 750px) {
  .main-blog__grid {
    grid-template-columns: repeat(var(--columns-desktop, 3), 1fr);
  }
}

.blog-card {
  background: var(--color-background);
  border-radius: var(--border-radius);
  overflow: hidden;
  border: 1px solid var(--color-border);
  transition: box-shadow 0.3s ease, transform 0.3s ease;
}

.blog-card:hover {
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
  transform: translateY(-4px);
}

.blog-card__image {
  display: block;
  aspect-ratio: 16/10;
  overflow: hidden;
}

.blog-card__image img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.5s ease;
}

.blog-card:hover .blog-card__image img {
  transform: scale(1.05);
}

.blog-card__content {
  padding: 1.5rem;
}

.blog-card__meta {
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 0.8125rem;
  color: var(--color-text-light);
  margin-bottom: 0.75rem;
}

.blog-card__meta time::after {
  content: 'Â·';
  margin-left: 1rem;
}

.blog-card__title {
  margin: 0 0 0.75rem;
  line-height: 1.3;
}

.blog-card__title a {
  color: inherit;
  text-decoration: none;
}

.blog-card__title a:hover {
  color: var(--color-primary);
}

.blog-card__excerpt {
  color: var(--color-text-light);
  font-size: 0.9375rem;
  line-height: 1.6;
  margin: 0 0 1rem;
}

.blog-card__link {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  color: var(--color-primary);
  font-size: 0.9375rem;
  font-weight: 500;
  text-decoration: none;
}

.blog-card__link:hover {
  text-decoration: underline;
}

.blog-card__link svg {
  width: 1rem;
  height: 1rem;
}

.main-blog__empty {
  text-align: center;
  padding: 3rem;
  color: var(--color-text-light);
}
</style>

{% schema %}
{
  "name": "Blog posts",
  "tag": "section",
  "class": "section-main-blog",
  "settings": [
    {
      "type": "range",
      "id": "articles_per_page",
      "min": 6,
      "max": 24,
      "step": 3,
      "default": 12,
      "label": "Articles per page"
    },
    {
      "type": "range",
      "id": "columns_desktop",
      "min": 2,
      "max": 4,
      "step": 1,
      "default": 3,
      "label": "Columns on desktop"
    },
    {
      "type": "select",
      "id": "columns_mobile",
      "label": "Columns on mobile",
      "options": [
        { "value": "1", "label": "1 column" },
        { "value": "2", "label": "2 columns" }
      ],
      "default": "1"
    },
    {
      "type": "checkbox",
      "id": "show_featured_image",
      "label": "Show featured image",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_date",
      "label": "Show date",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_author",
      "label": "Show author",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_excerpt",
      "label": "Show excerpt",
      "default": true
    }
  ]
}
{% endschema %}
